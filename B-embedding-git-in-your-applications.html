<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Embedding Git in your Applications - Pro Git</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="normalize.css" />
    <link rel="stylesheet" href="default.css" />
    <link rel="stylesheet" href="highlight.css" />
    <link rel="stylesheet" href="html.css" />
    <script src="html.js" defer></script>
  </head>
  <body>
    <div class="toolbar">
      <div class="toolbar-title">
        <a href="index.html">
          Pro Git
        </a>
      </div>
      <div class="toolbar-action">
        <div class="dropdown">
          <button id="drawer-button" type="button" class="dropdown-toggle button button-icon">
            <i class="fas fa-bars"></i>
          </button>
          <div id="toolbar-toc" class="dropdown-menu">
            
              <ol>
                
                  <li>
                    <a class="dropdown-menu-item" href="_asciibook_introduction.html">Asciibook Introduction</a>
                    
                  </li>
                
                  <li>
                    <a class="dropdown-menu-item" href="_table_of_contents.html">Table of Contents</a>
                    
                  </li>
                
                  <li>
                    <a class="dropdown-menu-item" href="_licence.html">Licence</a>
                    
                  </li>
                
                  <li>
                    <a class="dropdown-menu-item" href="_preface_by_scott_chacon.html">Preface by Scott Chacon</a>
                    
                  </li>
                
                  <li>
                    <a class="dropdown-menu-item" href="_preface_by_ben_straub.html">Preface by Ben Straub</a>
                    
                  </li>
                
                  <li>
                    <a class="dropdown-menu-item" href="_dedications.html">Dedications</a>
                    
                  </li>
                
                  <li>
                    <a class="dropdown-menu-item" href="_contributors.html">Contributors</a>
                    
                  </li>
                
                  <li>
                    <a class="dropdown-menu-item" href="_introduction.html">Introduction</a>
                    
                  </li>
                
                  <li>
                    <a class="dropdown-menu-item" href="ch01-getting-started.html">Getting Started</a>
                    
                      <ol>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch01-getting-started.html#_about_version_control">About Version Control</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch01-getting-started.html#_a_short_history_of_git">A Short History of Git</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch01-getting-started.html#_what_is_git">What is Git?</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch01-getting-started.html#_the_command_line">The Command Line</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch01-getting-started.html#_installing_git">Installing Git</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch01-getting-started.html#_first_time">First-Time Git Setup</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch01-getting-started.html#_git_help">Getting Help</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch01-getting-started.html#_summary">Summary</a>
                          </li>
                        
                      </ol>
                    
                  </li>
                
                  <li>
                    <a class="dropdown-menu-item" href="ch02-git-basics-chapter.html">Git Basics</a>
                    
                      <ol>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch02-git-basics-chapter.html#_getting_a_repo">Getting a Git Repository</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch02-git-basics-chapter.html#_recording_changes_to_the_repository">Recording Changes to the Repository</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch02-git-basics-chapter.html#_viewing_history">Viewing the Commit History</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch02-git-basics-chapter.html#_undoing">Undoing Things</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch02-git-basics-chapter.html#_remote_repos">Working with Remotes</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch02-git-basics-chapter.html#_git_tagging">Tagging</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch02-git-basics-chapter.html#_git_aliases">Git Aliases</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch02-git-basics-chapter.html#_summary_2">Summary</a>
                          </li>
                        
                      </ol>
                    
                  </li>
                
                  <li>
                    <a class="dropdown-menu-item" href="ch03-git-branching.html">Git Branching</a>
                    
                      <ol>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch03-git-branching.html#_git_branches_overview">Branches in a Nutshell</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch03-git-branching.html#_basic_branching_and_merging">Basic Branching and Merging</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch03-git-branching.html#_branch_management">Branch Management</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch03-git-branching.html#_branching_workflows">Branching Workflows</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch03-git-branching.html#_remote_branches">Remote Branches</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch03-git-branching.html#_rebasing">Rebasing</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch03-git-branching.html#_summary_3">Summary</a>
                          </li>
                        
                      </ol>
                    
                  </li>
                
                  <li>
                    <a class="dropdown-menu-item" href="ch04-git-on-the-server.html">Git on the Server</a>
                    
                      <ol>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch04-git-on-the-server.html#_the_protocols">The Protocols</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch04-git-on-the-server.html#_getting_git_on_a_server">Getting Git on a Server</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch04-git-on-the-server.html#_generate_ssh_key">Generating Your SSH Public Key</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch04-git-on-the-server.html#_setting_up_server">Setting Up the Server</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch04-git-on-the-server.html#_git_daemon">Git Daemon</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch04-git-on-the-server.html#_smart_http_2">Smart HTTP</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch04-git-on-the-server.html#_gitweb">GitWeb</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch04-git-on-the-server.html#_gitlab">GitLab</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch04-git-on-the-server.html#_third_party_hosted_options">Third Party Hosted Options</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch04-git-on-the-server.html#_summary_4">Summary</a>
                          </li>
                        
                      </ol>
                    
                  </li>
                
                  <li>
                    <a class="dropdown-menu-item" href="ch05-distributed-git.html">Distributed Git</a>
                    
                      <ol>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch05-distributed-git.html#_distributed_workflows">Distributed Workflows</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch05-distributed-git.html#_contributing_project">Contributing to a Project</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch05-distributed-git.html#_maintaining_a_project">Maintaining a Project</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch05-distributed-git.html#_summary_6">Summary</a>
                          </li>
                        
                      </ol>
                    
                  </li>
                
                  <li>
                    <a class="dropdown-menu-item" href="ch06-github.html">GitHub</a>
                    
                      <ol>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch06-github.html#_account_setup_and_configuration">Account Setup and Configuration</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch06-github.html#_contributing_to_a_project">Contributing to a Project</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch06-github.html#_maintaining_gh_project">Maintaining a Project</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch06-github.html#ch06-github_orgs">Managing an organization</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch06-github.html#_scripting_github">Scripting GitHub</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch06-github.html#_summary_7">Summary</a>
                          </li>
                        
                      </ol>
                    
                  </li>
                
                  <li>
                    <a class="dropdown-menu-item" href="ch07-git-tools.html">Git Tools</a>
                    
                      <ol>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch07-git-tools.html#_revision_selection">Revision Selection</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch07-git-tools.html#_interactive_staging">Interactive Staging</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch07-git-tools.html#_git_stashing">Stashing and Cleaning</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch07-git-tools.html#_signing">Signing Your Work</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch07-git-tools.html#_searching">Searching</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch07-git-tools.html#_rewriting_history">Rewriting History</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch07-git-tools.html#_git_reset">Reset Demystified</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch07-git-tools.html#_advanced_merging">Advanced Merging</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch07-git-tools.html#ref_rerere">Rerere</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch07-git-tools.html#_debugging_with_git">Debugging with Git</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch07-git-tools.html#_git_submodules">Submodules</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch07-git-tools.html#_bundling">Bundling</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch07-git-tools.html#_replace">Replace</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch07-git-tools.html#_credential_caching">Credential Storage</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch07-git-tools.html#_summary_9">Summary</a>
                          </li>
                        
                      </ol>
                    
                  </li>
                
                  <li>
                    <a class="dropdown-menu-item" href="ch08-customizing-git.html">Customizing Git</a>
                    
                      <ol>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch08-customizing-git.html#_git_config">Git Configuration</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch08-customizing-git.html#_git_attributes">Git Attributes</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch08-customizing-git.html#_git_hooks">Git Hooks</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch08-customizing-git.html#_an_example_git_enforced_policy">An Example Git-Enforced Policy</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch08-customizing-git.html#_summary_10">Summary</a>
                          </li>
                        
                      </ol>
                    
                  </li>
                
                  <li>
                    <a class="dropdown-menu-item" href="ch09-git-and-other-systems.html">Git and Other Systems</a>
                    
                      <ol>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch09-git-and-other-systems.html#_git_as_a_client">Git as a Client</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch09-git-and-other-systems.html#_migrating">Migrating to Git</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch09-git-and-other-systems.html#_summary_12">Summary</a>
                          </li>
                        
                      </ol>
                    
                  </li>
                
                  <li>
                    <a class="dropdown-menu-item" href="ch10-git-internals.html">Git Internals</a>
                    
                      <ol>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch10-git-internals.html#_plumbing_porcelain">Plumbing and Porcelain</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch10-git-internals.html#_objects">Git Objects</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch10-git-internals.html#_git_refs">Git References</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch10-git-internals.html#_packfiles">Packfiles</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch10-git-internals.html#_refspec">The Refspec</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch10-git-internals.html#_transfer_protocols">Transfer Protocols</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch10-git-internals.html#_maintenance_and_data_recovery">Maintenance and Data Recovery</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch10-git-internals.html#_environment_variables">Environment Variables</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="ch10-git-internals.html#_summary_13">Summary</a>
                          </li>
                        
                      </ol>
                    
                  </li>
                
                  <li>
                    <a class="dropdown-menu-item" href="A-git-in-other-environments.html">Git in Other Environments</a>
                    
                      <ol>
                        
                          <li>
                            <a class="dropdown-menu-item" href="A-git-in-other-environments.html#_graphical_interfaces">Graphical Interfaces</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="A-git-in-other-environments.html#_git_in_visual_studio">Git in Visual Studio</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="A-git-in-other-environments.html#_git_in_visual_studio_code">Git in Visual Studio Code</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="A-git-in-other-environments.html#_git_in_eclipse">Git in Eclipse</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="A-git-in-other-environments.html#_git_in_intellij_pycharm_webstorm_phpstorm_rubymine">Git in IntelliJ / PyCharm / WebStorm / PhpStorm / RubyMine</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="A-git-in-other-environments.html#_git_in_sublime_text">Git in Sublime Text</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="A-git-in-other-environments.html#_git_in_bash">Git in Bash</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="A-git-in-other-environments.html#_git_in_zsh">Git in Zsh</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="A-git-in-other-environments.html#_git_powershell">Git in PowerShell</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="A-git-in-other-environments.html#_summary_15">Summary</a>
                          </li>
                        
                      </ol>
                    
                  </li>
                
                  <li>
                    <a class="dropdown-menu-item" href="B-embedding-git-in-your-applications.html">Embedding Git in your Applications</a>
                    
                      <ol>
                        
                          <li>
                            <a class="dropdown-menu-item" href="B-embedding-git-in-your-applications.html#_command_line_git">Command-line Git</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="B-embedding-git-in-your-applications.html#_libgit2">Libgit2</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="B-embedding-git-in-your-applications.html#_jgit">JGit</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="B-embedding-git-in-your-applications.html#_go_git">go-git</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="B-embedding-git-in-your-applications.html#_dulwich">Dulwich</a>
                          </li>
                        
                      </ol>
                    
                  </li>
                
                  <li>
                    <a class="dropdown-menu-item" href="C-git-commands.html">Git Commands</a>
                    
                      <ol>
                        
                          <li>
                            <a class="dropdown-menu-item" href="C-git-commands.html#_setup_and_config">Setup and Config</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="C-git-commands.html#_getting_and_creating_projects">Getting and Creating Projects</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="C-git-commands.html#_basic_snapshotting">Basic Snapshotting</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="C-git-commands.html#_branching_and_merging">Branching and Merging</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="C-git-commands.html#_sharing_and_updating_projects">Sharing and Updating Projects</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="C-git-commands.html#_inspection_and_comparison">Inspection and Comparison</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="C-git-commands.html#_debugging_2">Debugging</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="C-git-commands.html#_patching">Patching</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="C-git-commands.html#_email">Email</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="C-git-commands.html#_external_systems">External Systems</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="C-git-commands.html#_administration_2">Administration</a>
                          </li>
                        
                          <li>
                            <a class="dropdown-menu-item" href="C-git-commands.html#_plumbing_commands">Plumbing Commands</a>
                          </li>
                        
                      </ol>
                    
                  </li>
                
                  <li>
                    <a class="dropdown-menu-item" href="_index.html">Index</a>
                    
                  </li>
                
              </ol>
            
          </div>
        </div>
      </div>
    </div>
    <div class="main">
      <div class="content">
        <section class="appendix" id="B-embedding-git-in-your-applications">
  <h1>Appendix B:  Embedding Git in your Applications</h1>
  <p >If your application is for developers, chances are good that it could benefit from integration with source control.
Even non-developer applications, such as document editors, could potentially benefit from version-control features, and Git&#8217;s model works very well for many different scenarios.</p>

<p >If you need to integrate Git with your application, you have essentially two options: spawn a shell and call the <code>git</code> command-line program, or embed a Git library into your application.
Here we&#8217;ll cover command-line integration and several of the most popular embeddable Git libraries.</p>

<section class="section" id="_command_line_git">
  <h2>Command-line Git</h2>
  <p >One option is to spawn a shell process and use the Git command-line tool to do the work.
This has the benefit of being canonical, and all of Git&#8217;s features are supported.
This also happens to be fairly easy, as most runtime environments have a relatively simple facility for invoking a process with command-line arguments.
However, this approach does have some downsides.</p>

<p >One is that all the output is in plain text.
This means that you&#8217;ll have to parse Git&#8217;s occasionally-changing output format to read progress and result information, which can be inefficient and error-prone.</p>

<p >Another is the lack of error recovery.
If a repository is corrupted somehow, or the user has a malformed configuration value, Git will simply refuse to perform many operations.</p>

<p >Yet another is process management.
Git requires you to maintain a shell environment on a separate process, which can add unwanted complexity.
Trying to coordinate many of these processes (especially when potentially accessing the same repository from several processes) can be quite a challenge.</p>

</section>

<section class="section" id="_libgit2">
  <h2>Libgit2</h2>
  <p ><a class="indexterm" id="_indexterm_245">&#8203;</a><a class="indexterm" id="_indexterm_246">&#8203;</a>
Another option at your disposal is to use Libgit2.
Libgit2 is a dependency-free implementation of Git, with a focus on having a nice API for use within other programs.
You can find it at <a class="link" href="https://libgit2.org"
     
      >https://libgit2.org</a>.</p>

<p >First, let&#8217;s take a look at what the C API looks like.
Here&#8217;s a whirlwind tour:</p>

<figure class="listing" >
  
  <pre>// Open a repository
git_repository *repo;
int error = git_repository_open(&amp;repo, "/path/to/repository");

// Dereference HEAD to a commit
git_object *head_commit;
error = git_revparse_single(&amp;head_commit, repo, "HEAD^{commit}");
git_commit *commit = (git_commit*)head_commit;

// Print some of the commit's properties
printf("%s", git_commit_message(commit));
const git_signature *author = git_commit_author(commit);
printf("%s &lt;%s&gt;\n", author-&gt;name, author-&gt;email);
const git_oid *tree_id = git_commit_tree_id(commit);

// Cleanup
git_commit_free(commit);
git_repository_free(repo);</pre>
</figure>

<p >The first couple of lines open a Git repository.
The <code>git_repository</code> type represents a handle to a repository with a cache in memory.
This is the simplest method, for when you know the exact path to a repository&#8217;s working directory or <code>.git</code> folder.
There&#8217;s also the <code>git_repository_open_ext</code> which includes options for searching, <code>git_clone</code> and friends for making a local clone of a remote repository, and <code>git_repository_init</code> for creating an entirely new repository.</p>

<p >The second chunk of code uses rev-parse syntax (see <a class="xref" href="ch07-git-tools.html#_branch_references">Branch References</a> for more on this) to get the commit that HEAD eventually points to.
The type returned is a <code>git_object</code> pointer, which represents something that exists in the Git object database for a repository.
<code>git_object</code> is actually a <code>parent'' type for several different kinds of objects; the memory layout for each of the </code>child'' types is the same as for <code>git_object</code>, so you can safely cast to the right one.
In this case, <code>git_object_type(commit)</code> would return <code>GIT_OBJ_COMMIT</code>, so it&#8217;s safe to cast to a <code>git_commit</code> pointer.</p>

<p >The next chunk shows how to access the commit&#8217;s properties.
The last line here uses a <code>git_oid</code> type; this is Libgit2&#8217;s representation for a SHA-1 hash.</p>

<p >From this sample, a couple of patterns have started to emerge:</p>

<ul class="ulist" >
  
    <li>
      <p>If you declare a pointer and pass a reference to it into a Libgit2 call, that call will probably return an integer error code.
A <code>0</code> value indicates success; anything less is an error.</p>
      
    </li>
  
    <li>
      <p>If Libgit2 populates a pointer for you, you&#8217;re responsible for freeing it.</p>
      
    </li>
  
    <li>
      <p>If Libgit2 returns a <code>const</code> pointer from a call, you don&#8217;t have to free it, but it will become invalid when the object it belongs to is freed.</p>
      
    </li>
  
    <li>
      <p>Writing C is a bit painful.</p>
      
    </li>
  
</ul>

<p ><a class="indexterm" id="_indexterm_247">&#8203;</a>
That last one means it isn&#8217;t very probable that you&#8217;ll be writing C when using Libgit2.
Fortunately, there are a number of language-specific bindings available that make it fairly easy to work with Git repositories from your specific language and environment.
Let&#8217;s take a look at the above example written using the Ruby bindings for Libgit2, which are named Rugged, and can be found at <a class="link" href="https://github.com/libgit2/rugged"
     
      >https://github.com/libgit2/rugged</a>.</p>

<figure class="listing" >
  
  <pre>repo = Rugged::Repository.new('path/to/repository')
commit = repo.head.target
puts commit.message
puts "#{commit.author[:name]} &lt;#{commit.author[:email]}&gt;"
tree = commit.tree</pre>
</figure>

<p >As you can see, the code is much less cluttered.
Firstly, Rugged uses exceptions; it can raise things like <code>ConfigError</code> or <code>ObjectError</code>  to signal error conditions.
Secondly, there&#8217;s no explicit freeing of resources, since Ruby is garbage-collected.
Let&#8217;s take a look at a slightly more complicated example: crafting a commit from scratch</p>

<figure class="listing" >
  
  <pre>blob_id = repo.write("Blob contents", :blob) <a class="callout" id="callout-CO10-1" href="#colist-CO10-1">1</a>

index = repo.index
index.read_tree(repo.head.target.tree)
index.add(:path =&gt; 'newfile.txt', :oid =&gt; blob_id) <a class="callout" id="callout-CO10-2" href="#colist-CO10-2">2</a>

sig = {
    :email =&gt; "bob@example.com",
    :name =&gt; "Bob User",
    :time =&gt; Time.now,
}

commit_id = Rugged::Commit.create(repo,
    :tree =&gt; index.write_tree(repo), <a class="callout" id="callout-CO10-3" href="#colist-CO10-3">3</a>
    :author =&gt; sig,
    :committer =&gt; sig, <a class="callout" id="callout-CO10-4" href="#colist-CO10-4">4</a>
    :message =&gt; "Add newfile.txt", <a class="callout" id="callout-CO10-5" href="#colist-CO10-5">5</a>
    :parents =&gt; repo.empty? ? [] : [ repo.head.target ].compact, <a class="callout" id="callout-CO10-6" href="#colist-CO10-6">6</a>
    :update_ref =&gt; 'HEAD', <a class="callout" id="callout-CO10-7" href="#colist-CO10-7">7</a>
)
commit = repo.lookup(commit_id) <a class="callout" id="callout-CO10-8" href="#colist-CO10-8">8</a></pre>
</figure>

<ul class="colist" >
  
    <li>
      <a class="callout" id="colist-CO10-1" href="#callout-CO10-1">1</a> Create a new blob, which contains the contents of a new file.
    </li>
  
    <li>
      <a class="callout" id="colist-CO10-2" href="#callout-CO10-2">2</a> Populate the index with the head commit&#8217;s tree, and add the new file at the path <code>newfile.txt</code>.
    </li>
  
    <li>
      <a class="callout" id="colist-CO10-3" href="#callout-CO10-3">3</a> This creates a new tree in the ODB, and uses it for the new commit.
    </li>
  
    <li>
      <a class="callout" id="colist-CO10-4" href="#callout-CO10-4">4</a> We use the same signature for both the author and committer fields.
    </li>
  
    <li>
      <a class="callout" id="colist-CO10-5" href="#callout-CO10-5">5</a> The commit message.
    </li>
  
    <li>
      <a class="callout" id="colist-CO10-6" href="#callout-CO10-6">6</a> When creating a commit, you have to specify the new commit&#8217;s parents.
This uses the tip of HEAD for the single parent.
    </li>
  
    <li>
      <a class="callout" id="colist-CO10-7" href="#callout-CO10-7">7</a> Rugged (and Libgit2) can optionally update a reference when making a commit.
    </li>
  
    <li>
      <a class="callout" id="colist-CO10-8" href="#callout-CO10-8">8</a> The return value is the SHA-1 hash of a new commit object, which you can then use to get a <code>Commit</code> object.
    </li>
  
</ul>

<p >The Ruby code is nice and clean, but since Libgit2 is doing the heavy lifting, this code will run pretty fast, too.
If you&#8217;re not a rubyist, we touch on some other bindings in <a class="xref" href="B-embedding-git-in-your-applications.html#_libgit2_bindings">Other Bindings</a>.</p>

<section class="section" id="_advanced_functionality">
  <h3>Advanced Functionality</h3>
  <p >Libgit2 has a couple of capabilities that are outside the scope of core Git.
One example is pluggability: Libgit2 allows you to provide custom ``backends'' for several types of operation, so you can store things in a different way than stock Git does.
Libgit2 allows custom backends for configuration, ref storage, and the object database, among other things.</p>

<p >Let&#8217;s take a look at how this works.
The code below is borrowed from the set of backend examples provided by the Libgit2 team (which can be found at <a class="link" href="https://github.com/libgit2/libgit2-backends"
     
      >https://github.com/libgit2/libgit2-backends</a>).
Here&#8217;s how a custom backend for the object database is set up:</p>

<figure class="listing" >
  
  <pre>git_odb *odb;
int error = git_odb_new(&amp;odb); <a class="callout" id="callout-CO11-1" href="#colist-CO11-1">1</a>

git_odb_backend *my_backend;
error = git_odb_backend_mine(&amp;my_backend, /*…*/); <a class="callout" id="callout-CO11-2" href="#colist-CO11-2">2</a>

error = git_odb_add_backend(odb, my_backend, 1); <a class="callout" id="callout-CO11-3" href="#colist-CO11-3">3</a>

git_repository *repo;
error = git_repository_open(&amp;repo, "some-path");
error = git_repository_set_odb(repo, odb); <a class="callout" id="callout-CO11-4" href="#colist-CO11-4">4</a></pre>
</figure>

<p ><em>(Note that errors are captured, but not handled. We hope your code is better than ours.)</em></p>

<ul class="colist" >
  
    <li>
      <a class="callout" id="colist-CO11-1" href="#callout-CO11-1">1</a> Initialize an empty object database (ODB) <code>frontend,'' which will act as a container for the </code>backends'' which are the ones doing the real work.
    </li>
  
    <li>
      <a class="callout" id="colist-CO11-2" href="#callout-CO11-2">2</a> Initialize a custom ODB backend.
    </li>
  
    <li>
      <a class="callout" id="colist-CO11-3" href="#callout-CO11-3">3</a> Add the backend to the frontend.
    </li>
  
    <li>
      <a class="callout" id="colist-CO11-4" href="#callout-CO11-4">4</a> Open a repository, and set it to use our ODB to look up objects.
    </li>
  
</ul>

<p >But what is this <code>git_odb_backend_mine</code> thing?
Well, that&#8217;s the constructor for your own ODB implementation, and you can do whatever you want in there, so long as you fill in the <code>git_odb_backend</code> structure properly.
Here&#8217;s what it <em>could</em> look like:</p>

<figure class="listing" >
  
  <pre>typedef struct {
    git_odb_backend parent;

    // Some other stuff
    void *custom_context;
} my_backend_struct;

int git_odb_backend_mine(git_odb_backend **backend_out, /*…*/)
{
    my_backend_struct *backend;

    backend = calloc(1, sizeof (my_backend_struct));

    backend-&gt;custom_context = …;

    backend-&gt;parent.read = &amp;my_backend__read;
    backend-&gt;parent.read_prefix = &amp;my_backend__read_prefix;
    backend-&gt;parent.read_header = &amp;my_backend__read_header;
    // …

    *backend_out = (git_odb_backend *) backend;

    return GIT_SUCCESS;
}</pre>
</figure>

<p >The subtlest constraint here is that <code>my_backend_struct&#8217;s first member must be a `git_odb_backend</code> structure; this ensures that the memory layout is what the Libgit2 code expects it to be.
The rest of it is arbitrary; this structure can be as large or small as you need it to be.</p>

<p >The initialization function allocates some memory for the structure, sets up the custom context, and then fills in the members of the <code>parent</code> structure that it supports.
Take a look at the <code>include/git2/sys/odb_backend.h</code> file in the Libgit2 source for a complete set of call signatures; your particular use case will help determine which of these you&#8217;ll want to support.</p>

</section>

<section class="section" id="_libgit2_bindings">
  <h3>Other Bindings</h3>
  <p >Libgit2 has bindings for many languages.
Here we show a small example using a few of the more complete bindings packages as of this writing; libraries exist for many other languages, including C++, Go, Node.js, Erlang, and the JVM, all in various stages of maturity.
The official collection of bindings can be found by browsing the repositories at <a class="link" href="https://github.com/libgit2"
     
      >https://github.com/libgit2</a>.
The code we&#8217;ll write will return the commit message from the commit eventually pointed to by HEAD (sort of like <code>git log -1</code>).</p>

<section class="section" id="_libgit2sharp">
  <h4>LibGit2Sharp</h4>
  <p ><a class="indexterm" id="_indexterm_248">&#8203;</a><a class="indexterm" id="_indexterm_249">&#8203;</a><a class="indexterm" id="_indexterm_250">&#8203;</a>
If you&#8217;re writing a .NET or Mono application, LibGit2Sharp (<a class="link" href="https://github.com/libgit2/libgit2sharp"
     
      >https://github.com/libgit2/libgit2sharp</a>) is what you&#8217;re looking for.
The bindings are written in C#, and great care has been taken to wrap the raw Libgit2 calls with native-feeling CLR APIs.
Here&#8217;s what our example program looks like:</p>

<figure class="listing" >
  
  <pre>new Repository(@"C:\path\to\repo").Head.Tip.Message;</pre>
</figure>

<p >For desktop Windows applications, there&#8217;s even a NuGet package that will help you get started quickly.</p>

</section>

<section class="section" id="_objective_git">
  <h4>objective-git</h4>
  <p ><a class="indexterm" id="_indexterm_251">&#8203;</a><a class="indexterm" id="_indexterm_252">&#8203;</a><a class="indexterm" id="_indexterm_253">&#8203;</a>
If your application is running on an Apple platform, you&#8217;re likely using Objective-C as your implementation language.
Objective-Git (<a class="link" href="https://github.com/libgit2/objective-git"
     
      >https://github.com/libgit2/objective-git</a>) is the name of the Libgit2 bindings for that environment.
The example program looks like this:</p>

<figure class="listing" >
  
  <pre>GTRepository *repo =
    [[GTRepository alloc] initWithURL:[NSURL fileURLWithPath: @"/path/to/repo"] error:NULL];
NSString *msg = [[[repo headReferenceWithError:NULL] resolvedTarget] message];</pre>
</figure>

<p >Objective-git is fully interoperable with Swift, so don&#8217;t fear if you&#8217;ve left Objective-C behind.</p>

</section>

<section class="section" id="_pygit2">
  <h4>pygit2</h4>
  <p ><a class="indexterm" id="_indexterm_254">&#8203;</a>
The bindings for Libgit2 in Python are called Pygit2, and can be found at <a class="link" href="https://www.pygit2.org"
     
      >https://www.pygit2.org</a>.
Our example program:</p>

<figure class="listing" >
  
  <pre>pygit2.Repository("/path/to/repo") # open repository
    .head                          # get the current branch
    .peel(pygit2.Commit)           # walk down to the commit
    .message                       # read the message</pre>
</figure>

</section>

</section>

<section class="section" id="_further_reading">
  <h3>Further Reading</h3>
  <p >Of course, a full treatment of Libgit2&#8217;s capabilities is outside the scope of this book.
If you want more information on Libgit2 itself, there&#8217;s API documentation at <a class="link" href="https://libgit2.github.com/libgit2"
     
      >https://libgit2.github.com/libgit2</a>, and a set of guides at <a class="link" href="https://libgit2.github.com/docs"
     
      >https://libgit2.github.com/docs</a>.
For the other bindings, check the bundled README and tests; there are often small tutorials and pointers to further reading there.</p>

</section>

</section>

<section class="section" id="_jgit">
  <h2>JGit</h2>
  <p ><a class="indexterm" id="_indexterm_255">&#8203;</a><a class="indexterm" id="_indexterm_256">&#8203;</a>
If you want to use Git from within a Java program, there is a fully featured Git library called JGit.
JGit is a relatively full-featured implementation of Git written natively in Java, and is widely used in the Java community.
The JGit project is under the Eclipse umbrella, and its home can be found at <a class="link" href="https://www.eclipse.org/jgit/"
     
      >https://www.eclipse.org/jgit/</a>.</p>

<section class="section" id="_getting_set_up">
  <h3>Getting Set Up</h3>
  <p >There are a number of ways to connect your project with JGit and start writing code against it.
Probably the easiest is to use Maven – the integration is accomplished by adding the following snippet to the <code>&lt;dependencies&gt;</code> tag in your pom.xml file:</p>

<figure class="listing" >
  
  <pre>&lt;dependency&gt;
    &lt;groupId&gt;org.eclipse.jgit&lt;/groupId&gt;
    &lt;artifactId&gt;org.eclipse.jgit&lt;/artifactId&gt;
    &lt;version&gt;3.5.0.201409260305-r&lt;/version&gt;
&lt;/dependency&gt;</pre>
</figure>

<p >The <code>version</code> will most likely have advanced by the time you read this; check <a class="link" href="https://mvnrepository.com/artifact/org.eclipse.jgit/org.eclipse.jgit"
     
      >https://mvnrepository.com/artifact/org.eclipse.jgit/org.eclipse.jgit</a> for updated repository information.
Once this step is done, Maven will automatically acquire and use the JGit libraries that you&#8217;ll need.</p>

<p >If you would rather manage the binary dependencies yourself, pre-built JGit binaries are available from <a class="link" href="https://www.eclipse.org/jgit/download"
     
      >https://www.eclipse.org/jgit/download</a>.
You can build them into your project by running a command like this:</p>

<figure class="listing" >
  
  <pre>javac -cp .:org.eclipse.jgit-3.5.0.201409260305-r.jar App.java
java -cp .:org.eclipse.jgit-3.5.0.201409260305-r.jar App</pre>
</figure>

</section>

<section class="section" id="_plumbing">
  <h3>Plumbing</h3>
  <p >JGit has two basic levels of API: plumbing and porcelain.
The terminology for these comes from Git itself, and JGit is divided into roughly the same kinds of areas: porcelain APIs are a friendly front-end for common user-level actions (the sorts of things a normal user would use the Git command-line tool for), while the plumbing APIs are for interacting with low-level repository objects directly.</p>

<p >The starting point for most JGit sessions is the <code>Repository</code> class, and the first thing you&#8217;ll want to do is create an instance of it.
For a filesystem-based repository (yes, JGit allows for other storage models), this is accomplished using <code>FileRepositoryBuilder</code>:</p>

<figure class="listing" >
  
  <pre>// Create a new repository
Repository newlyCreatedRepo = FileRepositoryBuilder.create(
    new File("/tmp/new_repo/.git"));
newlyCreatedRepo.create();

// Open an existing repository
Repository existingRepo = new FileRepositoryBuilder()
    .setGitDir(new File("my_repo/.git"))
    .build();</pre>
</figure>

<p >The builder has a fluent API for providing all the things it needs to find a Git repository, whether or not your program knows exactly where it&#8217;s located.
It can use environment variables (<code>.readEnvironment()</code>), start from a place in the working directory and search (<code>.setWorkTree(…).findGitDir()</code>), or just open a known <code>.git</code> directory as above.</p>

<p >Once you have a <code>Repository</code> instance, you can do all sorts of things with it.
Here&#8217;s a quick sampling:</p>

<figure class="listing" >
  
  <pre>// Get a reference
Ref master = repo.getRef("master");

// Get the object the reference points to
ObjectId masterTip = master.getObjectId();

// Rev-parse
ObjectId obj = repo.resolve("HEAD^{tree}");

// Load raw object contents
ObjectLoader loader = repo.open(masterTip);
loader.copyTo(System.out);

// Create a branch
RefUpdate createBranch1 = repo.updateRef("refs/heads/branch1");
createBranch1.setNewObjectId(masterTip);
createBranch1.update();

// Delete a branch
RefUpdate deleteBranch1 = repo.updateRef("refs/heads/branch1");
deleteBranch1.setForceUpdate(true);
deleteBranch1.delete();

// Config
Config cfg = repo.getConfig();
String name = cfg.getString("user", null, "name");</pre>
</figure>

<p >There&#8217;s quite a bit going on here, so let&#8217;s go through it one section at a time.</p>

<p >The first line gets a pointer to the <code>master</code> reference.
JGit automatically grabs the <em>actual</em> <code>master</code> ref, which lives at <code>refs/heads/master</code>, and returns an object that lets you fetch information about the reference.
You can get the name (<code>.getName()</code>), and either the target object of a direct reference (<code>.getObjectId()</code>) or the reference pointed to by a symbolic ref (<code>.getTarget()</code>).
Ref objects are also used to represent tag refs and objects, so you can ask if the tag is ``peeled,'' meaning that it points to the final target of a (potentially long) string of tag objects.</p>

<p >The second line gets the target of the <code>master</code> reference, which is returned as an ObjectId instance.
ObjectId represents the SHA-1 hash of an object, which might or might not exist in Git&#8217;s object database.
The third line is similar, but shows how JGit handles the rev-parse syntax (for more on this, see <a class="xref" href="ch07-git-tools.html#_branch_references">Branch References</a>); you can pass any object specifier that Git understands, and JGit will return either a valid ObjectId for that object, or <code>null</code>.</p>

<p >The next two lines show how to load the raw contents of an object.
In this example, we call <code>ObjectLoader.copyTo()</code> to stream the contents of the object directly to stdout, but ObjectLoader also has methods to read the type and size of an object, as well as return it as a byte array.
For large objects (where <code>.isLarge()</code> returns <code>true</code>), you can call <code>.openStream()</code> to get an InputStream-like object that can read the raw object data without pulling it all into memory at once.</p>

<p >The next few lines show what it takes to create a new branch.
We create a RefUpdate instance, configure some parameters, and call <code>.update()</code> to trigger the change.
Directly following this is the code to delete that same branch.
Note that <code>.setForceUpdate(true)</code> is required for this to work; otherwise the <code>.delete()</code> call will return <code>REJECTED</code>, and nothing will happen.</p>

<p >The last example shows how to fetch the <code>user.name</code> value from the Git configuration files.
This Config instance uses the repository we opened earlier for local configuration, but will automatically detect the global and system configuration files and read values from them as well.</p>

<p >This is only a small sampling of the full plumbing API; there are many more methods and classes available.
Also not shown here is the way JGit handles errors, which is through the use of exceptions.
JGit APIs sometimes throw standard Java exceptions (such as <code>IOException</code>), but there are a host of JGit-specific exception types that are provided as well (such as <code>NoRemoteRepositoryException</code>, <code>CorruptObjectException</code>, and <code>NoMergeBaseException</code>).</p>

</section>

<section class="section" id="_porcelain">
  <h3>Porcelain</h3>
  <p >The plumbing APIs are rather complete, but it can be cumbersome to string them together to achieve common goals, like adding a file to the index, or making a new commit.
JGit provides a higher-level set of APIs to help out with this, and the entry point to these APIs is the <code>Git</code> class:</p>

<figure class="listing" >
  
  <pre>Repository repo;
// construct repo...
Git git = new Git(repo);</pre>
</figure>

<p >The Git class has a nice set of high-level <em>builder</em>-style methods that can be used to construct some pretty complex behavior.
Let&#8217;s take a look at an example – doing something like <code>git ls-remote</code>:</p>

<figure class="listing" >
  
  <pre>CredentialsProvider cp = new UsernamePasswordCredentialsProvider("username", "p4ssw0rd");
Collection&lt;Ref&gt; remoteRefs = git.lsRemote()
    .setCredentialsProvider(cp)
    .setRemote("origin")
    .setTags(true)
    .setHeads(false)
    .call();
for (Ref ref : remoteRefs) {
    System.out.println(ref.getName() + " -&gt; " + ref.getObjectId().name());
}</pre>
</figure>

<p >This is a common pattern with the Git class; the methods return a command object that lets you chain method calls to set parameters, which are executed when you call <code>.call()</code>.
In this case, we&#8217;re asking the <code>origin</code> remote for tags, but not heads.
Also notice the use of a <code>CredentialsProvider</code> object for authentication.</p>

<p >Many other commands are available through the Git class, including but not limited to <code>add</code>, <code>blame</code>, <code>commit</code>, <code>clean</code>, <code>push</code>, <code>rebase</code>, <code>revert</code>, and <code>reset</code>.</p>

</section>

<section class="section" id="_further_reading_2">
  <h3>Further Reading</h3>
  <p >This is only a small sampling of JGit&#8217;s full capabilities.
If you&#8217;re interested and want to learn more, here&#8217;s where to look for information and inspiration:</p>

<ul class="ulist" >
  
    <li>
      <p>The official JGit API documentation can be found at <a class="link" href="https://www.eclipse.org/jgit/documentation"
     
      >https://www.eclipse.org/jgit/documentation</a>.
These are standard Javadoc, so your favorite JVM IDE will be able to install them locally, as well.</p>
      
    </li>
  
    <li>
      <p>The JGit Cookbook at <a class="link" href="https://github.com/centic9/jgit-cookbook"
     
      >https://github.com/centic9/jgit-cookbook</a> has many examples of how to do specific tasks with JGit.</p>
      
    </li>
  
</ul>

</section>

</section>

<section class="section" id="_go_git">
  <h2>go-git</h2>
  <p ><a class="indexterm" id="_indexterm_257">&#8203;</a><a class="indexterm" id="_indexterm_258">&#8203;</a>
In case you want to integrate Git into a service written in Golang, there also is a pure Go library implementation.
This implementation does not have any native dependencies and thus is not prone to manual memory management errors.
It is also transparent for the standard Golang performance analysis tooling like CPU, Memory profilers, race detector, etc.</p>

<p >go-git is focused on extensibility, compatibility and supports most of the plumbing APIs, which is documented at <a class="link" href="https://github.com/src-d/go-git/blob/master/COMPATIBILITY.md"
     
      >https://github.com/src-d/go-git/blob/master/COMPATIBILITY.md</a>.</p>

<p >Here is a basic example of using Go APIs:</p>

<figure class="listing" >
  
  <pre>import 	"gopkg.in/src-d/go-git.v4"

r, err := git.PlainClone("/tmp/foo", false, &amp;git.CloneOptions{
    URL:      "https://github.com/src-d/go-git",
    Progress: os.Stdout,
})</pre>
</figure>

<p >As soon as you have a <code>Repository</code> instance, you can access information and perform mutations on it:</p>

<figure class="listing" >
  
  <pre>// retrieves the branch pointed by HEAD
ref, err := r.Head()

// get the commit object, pointed by ref
commit, err := r.CommitObject(ref.Hash())

// retrieves the commit history
history, err := commit.History()

// iterates over the commits and print each
for _, c := range history {
    fmt.Println(c)
}</pre>
</figure>

<section class="section" id="_advanced_functionality_2">
  <h3>Advanced Functionality</h3>
  <p >go-git has few notable advanced features, one of which is a pluggable storage system, which is similar to Libgit2 backends.
The default implementation is in-memory storage, which is very fast.</p>

<figure class="listing" >
  
  <pre>r, err := git.Clone(memory.NewStorage(), nil, &amp;git.CloneOptions{
    URL: "https://github.com/src-d/go-git",
})</pre>
</figure>

<p >Pluggable storage provides many interesting options.
For instance, <a class="link" href="https://github.com/src-d/go-git/tree/master/_examples/storage"
     
      >https://github.com/src-d/go-git/tree/master/_examples/storage</a> allows you to store references, objects, and configuration in an Aerospike database.</p>

<p >Another feature is a flexible filesystem abstraction.
Using <a class="link" href="https://godoc.org/github.com/src-d/go-billy#Filesystem"
     
      >https://godoc.org/github.com/src-d/go-billy#Filesystem</a> it is easy to store all the files in different way i.e by packing all of them to a single archive on disk or by keeping them all in-memory.</p>

<p >Another advanced use-case includes a fine-tunable HTTP client, such as the one found at <a class="link" href="https://github.com/src-d/go-git/blob/master/_examples/custom_http/main.go"
     
      >https://github.com/src-d/go-git/blob/master/_examples/custom_http/main.go</a>.</p>

<figure class="listing" >
  
  <pre>customClient := &amp;http.Client{
	Transport: &amp;http.Transport{ // accept any certificate (might be useful for testing)
		TLSClientConfig: &amp;tls.Config{InsecureSkipVerify: true},
	},
	Timeout: 15 * time.Second,  // 15 second timeout
		CheckRedirect: func(req *http.Request, via []*http.Request) error {
		return http.ErrUseLastResponse // don't follow redirect
	},
}

// Override http(s) default protocol to use our custom client
client.InstallProtocol("https", githttp.NewClient(customClient))

// Clone repository using the new client if the protocol is https://
r, err := git.Clone(memory.NewStorage(), nil, &amp;git.CloneOptions{URL: url})</pre>
</figure>

</section>

<section class="section" id="_further_reading_3">
  <h3>Further Reading</h3>
  <p >A full treatment of go-git&#8217;s capabilities is outside the scope of this book.
If you want more information on go-git, there&#8217;s API documentation at <a class="link" href="https://godoc.org/gopkg.in/src-d/go-git.v4"
     
      >https://godoc.org/gopkg.in/src-d/go-git.v4</a>, and a set of usage examples at <a class="link" href="https://github.com/src-d/go-git/tree/master/_examples"
     
      >https://github.com/src-d/go-git/tree/master/_examples</a>.</p>

</section>

</section>

<section class="section" id="_dulwich">
  <h2>Dulwich</h2>
  <p ><a class="indexterm" id="_indexterm_259">&#8203;</a><a class="indexterm" id="_indexterm_260">&#8203;</a>
There is also a pure-Python Git implementation - Dulwich.
The project is hosted under <a class="link" href="https://www.dulwich.io/"
     
      >https://www.dulwich.io/</a>
It aims to provide an interface to git repositories (both local and remote) that doesn&#8217;t call out to git directly but instead uses pure Python.
It has an optional C extensions though, that significantly improve the performance.</p>

<p >Dulwich follows git design and separate two basic levels of API: plumbing and porcelain.</p>

<p >Here is an example of using the lower level API to access the commit message of the last commit:</p>

<figure class="listing" >
  
  <pre>from dulwich.repo import Repo
r = Repo('.')
r.head()
# '57fbe010446356833a6ad1600059d80b1e731e15'

c = r[r.head()]
c
# &lt;Commit 015fc1267258458901a94d228e39f0a378370466&gt;

c.message
# 'Add note about encoding.\n'</pre>
</figure>

<p >To print a commit log using high-level porcelain API, one can use:</p>

<figure class="listing" >
  
  <pre>from dulwich import porcelain
porcelain.log('.', max_entries=1)

#commit: 57fbe010446356833a6ad1600059d80b1e731e15
#Author: Jelmer Vernooĳ &lt;jelmer@jelmer.uk&gt;
#Date:   Sat Apr 29 2017 23:57:34 +0000</pre>
</figure>

<section class="section" id="_further_reading_4">
  <h3>Further Reading</h3>
  <ul class="ulist" >
  
    <li>
      <p>The official API documentation is available at <a class="link" href="https://www.dulwich.io/apidocs/dulwich.html"
     
      >https://www.dulwich.io/apidocs/dulwich.html</a></p>
      
    </li>
  
    <li>
      <p>Official tutorial at <a class="link" href="https://www.dulwich.io/docs/tutorial"
     
      >https://www.dulwich.io/docs/tutorial</a> has many examples of how to do specific tasks with Dulwich</p>
      
    </li>
  
</ul>

</section>

</section>

</section>

      </div>
      <div class="paginator">
        <a href="A-git-in-other-environments.html" class="paginator-prev ">
          <i class="fas fa-chevron-left"></i>
        </a>
        <a href="C-git-commands.html" class="paginator-next ">
          <i class="fas fa-chevron-right"></i>
        </a>
      </div>
    </div>
  </body>
</html>
